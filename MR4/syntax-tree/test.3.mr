## MR4 compiler - Syntax tree testing nodes

## Assert statement in the syntax tree
class SyntaxTreeAssert(SyntaxTreeCode)
  owner Expression tested
  
  func inst parse-new(user SyntaxTreeBlock parent):(
      copy Char end, owner SyntaxTreeAssert new-node)
    new SyntaxTreeAssert in new-node
    new-node.parse(user parent):(copy end)
  
  func inst parse(user SyntaxTreeBlock parent):(copy Char end)
    self.parent := parent
    self.set-location()
    parse-new-expression(user "", user self):(owner self.tested, copy end)
  
  func dynamic analyze()
    self.analyze-expression(user self.tested, user glob.type-bool)
  
  func dynamic write()
    # TEST_ASSERT(`line`, `tested`)
    self.tested.write-preactions()
    write(user "TEST_ASSERT(")
    self.write-line-num()
    write(user ", ")
    self.tested.write()
    write(user ")")

## Assert-error statement in the syntax tree
class SyntaxTreeAssertError(SyntaxTreeCode)
  owner Expression tested
  
  func inst parse-new(user SyntaxTreeBlock parent):(
      copy Char end, owner SyntaxTreeAssertError new-node)
    new SyntaxTreeAssertError in new-node
    new-node.parse(user parent):(copy end)
  
  func inst parse(user SyntaxTreeBlock parent):(copy Char end)
    self.parent := parent
    self.set-location()
    parse-new-expression(user "", user self):(owner self.tested, copy end)
    self.tested.is-statement := true
    self.m-syntax-error-msg(user "assert-error not supported yet...")
  
  func dynamic analyze()
    self.tested.analyze()


## Test function in the syntax tree
class SyntaxTreeTestFunction(SyntaxTreeFunction)
  func inst parse-new():(copy Char end, owner SyntaxTreeTestFunction new-node)
    new SyntaxTreeTestFunction in new-node
    new-node.parse(user _):(copy end)
    self.m-syntax-error-msg(user "test-function not supported yet...")


## Mock function in the syntax tree
class SyntaxTreeMockFunction(SyntaxTreeFunction)
  func inst parse-new():(copy Char end, owner SyntaxTreeMockFunction new-node)
    new SyntaxTreeMockFunction in new-node
    new-node.parse(user _):(copy end)
    self.m-syntax-error-msg(user "mock not supported yet...")

